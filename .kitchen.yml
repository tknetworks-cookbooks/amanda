---
driver_plugin: vagrant
driver_config:
  require_chef_omnibus: false

platforms:
- name: vagrant-openbsd-55
  driver_config:
    box: vagrant-openbsd-55-chef
    box_url: http://projects.tsuntsun.net/~nabeken/boxes/vagrant-openbsd-55-chef.box
- name: debian-wheezy
  driver_config:
    box: debian-wheezy
    box_url: http://projects.tsuntsun.net/~nabeken/boxes/vagrant-debian-wheezy.box
  run_list:
  - recipe[apt]

suites:
- name: server
  run_list:
  - recipe[amanda_test]
  - recipe[amanda::server]
  - recipe[minitest-handler]
  encrypted_data_bag_secret_key_path: test/integration/secret_key
  attributes:
    amanda:
      conf_cookbook: "amanda_test"
- name: client
  run_list:
  - recipe[amanda::client]
  attributes:
    amanda:
      conf_cookbook: "amanda_test"
      client:
        from: "192.168.1.1"
        pubkey: "PUBKEY"
